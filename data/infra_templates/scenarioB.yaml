# this is the legacy template format that we've been using to specify simulation infra

# this is basically 1 VM per host and 1 cloudlet per host/vm. 100 hosts and 100 cloudlets, so everything running in parallel

# workload length is -1, so all run continuously until they are interrupted on the 1 hour mark

hostSpecification:
  hosts: 10
  host_pes: 16
  host_mips: 1000
  host_ram: 2048
  host_bw: 10_000
  host_storage: 1_000_000

vmSpecification:
  vms: 10
  vm_pes: 16
  vm_mips: 1000
  vm_ram: 2048
  vm_bw: 1000
  vm_storage: 10_000

# note - some cloudlet configuration is independent of the abstracted app type
# the number of cloudlets will generally match the available hardware (for parallel processing)
cloudletSpecification:
  # WEB
  cloudlet_pes: 1 # a web request will generally be single-threaded (used to set this to 16, to max out all cores - not realistic)
  cloudlet_length: 1_000

  # BATCH
  #cloudlet_pes: 16
  #cloudlet_length: 3_500_000 # overall capacity / server count / core count (minus a bit to ensure the jobs finish). one to each core
  #cloudlet_length: 1_750_000 # half
  #cloudlet_length: 2_625_000 # 3/4

  # FIXME maybe randomise the bit I subtract, to simulate randomness in job length? not urgent
  # what's going on here - moving to 4 and above, to get above 10% utilisation, means nothing gets finished!
  # think about it - need more than 1 cloudlet
  #cloudlet_length: -1  # this approach is no longer used
  #sim_total_work: -1   # this approach is no longer used (we can always work it out)
  #cloudlets: 100       # this approach is no longer used (now determined by app type)
  #cloudlet_utilisation: 1

# WEB or BATCH, determines which spec to pick up below
applicationType: WEB
#applicationType: BATCH

webAppSpecification:
  arrival_interval: 10
  # 1000 every 1 second results in too many cloudlets to log easily!
  # 500 every 1 second is roughly 50% capacity
  # implied (in code) - 1 cloudlet per VM
  # needs an end time!?

batchAppSpecification:
  # length needs to be the theoretical max processing capacity (57_600_000)
  # divided by number of cores (because each will contribute a share of total)
  # and then slightly smaller to ensure they all have time to finish
  # otherwise you end up with nothing finishing and zero work done!
  # ((57_600_000 / 16)-50000)
  cloudlet_count: 10 # can't go above VM count! 10 would mean each VM gets one, basically